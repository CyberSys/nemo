#!/bin/echo Usage: source 
###
###  Standard C-shell setup for NEMO V3.2 environment:
###
###	1) define the NEMO environment variable 
###	2) source this file
###	3) optionally add to NEMORC.local and your ~/.nemorc file
###	3) add $NEMOBIN to the search path
###
###  Do not edit this file, instead edit :
###	NEMORC.local        for local site additions (only created after configure/scripts)
###     $NEMOLIB/NEMORC     for local architecture additions
###     $HOME/.nemorc       for user additions

# 				try and set NEMO if it didn't exist 
if ($?NEMO == 0) then
  foreach v (/home/nemo /usr/nemo /usr/local/nemo /local/nemo $HOME/nemo)
    if (-d $v && -e $v/NEMORC) then
      setenv NEMO $v
    endif
  end
  if ($?NEMO == 0) then
    echo "### Fatal error: in NEMORC file: missing environment variable NEMO"
    goto end
  endif
endif

# 				resolve the hosttype NEMOHOST if not given yet
if ($?NEMOHOST == 0) then
   if (-x $NEMO/config.guess) then
	# this is the new NEMO V3 method, but needs execution from a writeable directory!
	setenv NEMOHOST `(chdir /tmp;$NEMO/config.guess)`
   else if (-x $NEMO/src/scripts/hosttype) then
	# this is the old NEMO V2 method
   	setenv NEMOHOST `$NEMO/src/scripts/hosttype`
   else
        echo "### Warning: no script config.guess or src/scripts/hosttype"
        echo "NEMORC: Warning: using unknown NEMOHOST"
	setenv NEMOHOST unknown
   endif
endif

#  				Basic derived environment variables
setenv NEMOLIB $NEMO/lib
setenv NEMOBIN $NEMO/bin
setenv NEMOOBJ $NEMO/obj
setenv NEMODOC $NEMO/man/doc
setenv NEMODAT $NEMO/data
setenv NEMOINC $NEMO/inc
setenv NEMOSRC $NEMO/src
setenv BTRPATH .:$NEMO/obj/bodytrans
setenv POTPATH .:$NEMO/obj/potential
if (-e $NEMO/VERSION) then
  setenv NEMOVER `cat $NEMO/VERSION`
else
  setenv NEMOVER old
endif

#	? Ultrix doesn't handle MANPATH
#	IRIX is also particular about MANPATH
#       Linux needs to have their stuff added back in if none present
if ($?MANPATH == 0) then
 setenv MANPATH $NEMO/man
 foreach mandir (/usr/man /usr/share/man /usr/local/man /local/man /opt/man /opt/SUNWspro/man /usr/openwin/man)
   if (-e $mandir) then
      setenv MANPATH ${MANPATH}:$mandir
   endif
 end
else
 echo $MANPATH | grep -s $NEMO/man  >& /dev/null
 if ($status) setenv MANPATH $NEMO/man:$MANPATH
endif

# Set various 'external' things we sometimes need, but only if not set

if ($?NUMRECLIB == 0)  setenv NUMRECLIB $NEMOLIB/libnumrec.a
if ($?GRAVSIM == 0)    setenv GRAVSIM $NEMO/usr/mbellon/gravsim
if ($?PLPLOT_LIB == 0) setenv PLPLOT_LIB $NEMOLIB

# some useful (?) aliases

#alias keys "ls *.def"
if (-e $NEMOBIN/miriad) alias nemo "miriad -b $NEMOBIN -p $NEMODOC -d ."
alias motd 'more $NEMO/etc/motd'
alias lmake 'make -f $NEMOLIB/Makefile.lib'
alias omake 'make -f $NEMOLIB/Makefile.obj'
alias bake  'make -f $NEMOLIB/Makefile.lib'
alias Test  'make -f Testfile'
alias makedefs 'make -f $NEMOLIB/makedefs makedefs_help'


# Required dummy defaults that should be overriden in NEMORC.local
# setenv YAPPLIB $YAPP_NULL
setenv NEMOSITE unknown


#       this is where site dependancies reside (see template in: NEMORC.gen)
if (-e $NEMO/NEMORC.local) then
    source $NEMO/NEMORC.local
else
    source $NEMO/NEMORC.gen
endif

#	this is where the site manager can hide architecture dependant things
if (-e $NEMOLIB/NEMORC) source $NEMOLIB/NEMORC

#	this is where each user can hide its own things
if ($?HOME) then
  if (-e $HOME/.nemorc) source $HOME/.nemorc
endif

# unset local shell variables
unset v

# compatibilty check

if (-d $NEMO/host) then
  echo '*** You still have a $NEMO/host directory, suggestive that you have        ***'
  echo '*** not made the change to version 3.2.x and above where we use $NEMO/opt  ***'
  echo "*** for NEMO=$NEMO"
endif

end:
